module CVE_2020_0601;

export {
	redef enum Notice::Type += {
		## An ECC certificate with an unknown curve was encountered
		Unknown_X509_Curve
	};
}

event x509_certificate(f: fa_file, cert_ref: opaque of x509, cert: X509::Certificate)
	{
	if ( cert?$key_alg && cert$key_alg == "id-ecPublicKey" && ! cert?$curve )
		NOTICE([$note=Unknown_X509_Curve, $f=f, $msg="ECC certificate with unknown curve; potential CVE-2020-0601 exploit attempt"]);
	}
